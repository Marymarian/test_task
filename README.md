# test_task

## Тестовое задание

Используя язык Python, необходимо разработать скрипт по загрузке исторических данных из источников в формате .xlsx в БД SQLite.


## Вводные данные

1. На вход поступают одинаковые по структуре файлы в формате xlsx: количество и название колонок фиксированное, количество строк с данными различно.

2. В источниках могут содержаться ошибки типов данных, пустые ячейки, ячейки с ошибками НД. Ошибки не должны попадать в таблицы БД.

3. Источники приходят пакетами, раз в месяц/неделю.

* Скрипт должен запускаться из файла main.py, после успешной работы в корне проекта создается файл БД sqlite с загруженными данными.


## Распаковка проекта

- Установка и активация виртуального окружения:
```
python -m venv venv
```
``` 
source venv/Scripts/activate
``` 
- Установка зависимостей из файла requirements.txt:
```
pip install -r requirements.txt
``` 
- Запуск скрипта:
```
python main.py
``` 


## Структура и содержимое

### Структура проекта
- sources - директория с источниками .xlsx, которые поступают на вход работы скрипта. (добавляется в gitignore);
- .gitignore;
- conditional_schedule.py - файл с условным графиком по кадру данных;
- core.py - файл с основным кодом;
- main.py - файл запуска скрипта;
- README - описание проекта;
- requirements.txt - зависимости;

### Введенные функции

- load_sql - Создает БД и загружает в нее данные из подготовленного DataFrame.

- preparing_file - функция для обработки пустых ячеек и ошибок. На вход принимает filename - файл источника. Возвращает обработанный DataFrame.


## Технологии

Python 3.11.0 (Pandas, Matplotlib, SQLite3)


## Авторы

Марина Чухарева
- [@Marymarian](https://www.github.com/Marymarian)





